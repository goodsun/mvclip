# ローカルファイルアップロード機能

## 🎯 概要

YouTube動画以外にも、手持ちの動画ファイルから字幕付き切り抜き動画を作成できます。

## 🚀 新機能

### 1. ローカル動画ファイルのアップロード
- **対応形式**: MP4, MOV, AVI, MKV, WebM, FLV, WMV, M4V
- **最大サイズ**: 500MB
- **処理**: 自動的に高画質版・解析用の2つのファイルを生成

### 2. 動画・静止画結合機能
- **動画結合**: 既存動画の前後に他の動画を追加
- **静止画結合**: 画像を指定秒数の動画として挿入
- **対応静止画**: JPG, PNG, GIF, BMP, WebP, TIFF
- **秒数指定**: 0.1～600秒（デフォルト3秒）

## 💡 使い方

### ローカル動画のプロジェクト作成
1. 「新規作成」ボタンをクリック
2. 「ローカルファイル」タブを選択
3. 動画ファイルを選択
4. プロジェクト名を入力
5. 「作成」ボタンでプロジェクト作成

### 動画・静止画の結合
1. プロジェクトを選択
2. 高画質版エリアの「📎 動画・静止画を結合」ボタン
3. ファイル種類を選択（📹 動画 or 🖼️ 静止画）
4. 静止画の場合は表示時間を指定
5. 結合位置を選択（前に挿入 or 後ろに追加）
6. ファイルを選択して「📎 結合」ボタン

## ⚙️ 技術仕様

### 自動正規化
- **フレームレート**: 30fpsに統一
- **解像度**: 既存動画に合わせて自動調整
- **音声**: 48kHz、ステレオに統一

### 静止画変換
- **FFmpeg処理**: 静止画を指定秒数の動画に変換
- **音声トラック**: 無音声トラックを自動追加
- **品質**: 元画像の解像度を維持

## 📁 ファイル管理

### プロジェクト構造
```
workdir/{projectId}/
├── project.json          # メタデータ
├── video_high.mp4        # 高画質版（編集用）
├── video_analysis.mp4    # 解析用（プレビュー用）
└── subtitles.csv         # 字幕データ
```

### バックアップ
- 動画結合時は自動的にバックアップを作成
- ファイル名: `video_high_backup_{timestamp}.mp4`

## ⚠️ 注意事項

### ファイルサイズ制限
- **アップロード**: 最大500MB
- **Whisper API**: 音声ファイルは25MB制限（自動最適化）

### 対応形式
- **動画**: 一般的な形式に対応
- **静止画**: Web標準形式に対応
- **非対応**: DRM保護されたファイル

### パフォーマンス
- 大容量ファイルは処理に時間がかかります
- 結合処理中は他の操作を控えてください

## 🔧 トラブルシューティング

### アップロード失敗
1. ファイルサイズを確認（500MB未満）
2. ファイル形式を確認
3. ブラウザを再読み込み

### 結合エラー
1. 既存動画の状態を確認
2. 結合ファイルの形式を確認
3. 十分な空き容量があるか確認

### 音声同期の問題
- 自動正規化により解決される場合がほとんど
- 問題が続く場合は元ファイルの品質を確認

## 🎬 活用例

### 動画制作ワークフロー
1. **イントロ作成**: ロゴ画像を3秒動画として前に挿入
2. **メインコンテンツ**: ローカル動画をアップロード
3. **エンディング**: 別の動画ファイルを後ろに結合
4. **字幕追加**: Whisper APIで自動字幕生成
5. **最終編集**: CSVで字幕を調整して完成

### 教育コンテンツ
- 講義録画をアップロード
- タイトル画面を前に追加
- 質疑応答部分を後ろに結合
- 自動字幕で アクセシビリティ向上